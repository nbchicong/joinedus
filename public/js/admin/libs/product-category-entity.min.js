/*
 Copyright (c) 2016 CT1905
 Created by Nguyen Ba Chi Cong <nbchicong@gmail.com>
 ---------------------------------------------------
*/
$(function(){UI.ProductCategoryEntity=function(){var a=this,c=listCate||[];this.id="product-category";this.submitType="JSON";this.$toolbar={CREATE:$("#btn-add")};this.url={list:"category/list.svc",create:"category/create.svc",update:"category/update.svc",remove:"category/remove.svc"};this.$listItem=$("#list-items");this.dataSource=new UI.grid.DataSource({columns:[{type:"selection",align:"center",width:30},{property:"name",label:"T\u00ean th\u1ec3 lo\u1ea1i",sortable:true,type:"text",align:"left"},
{property:"parentCateId",label:"Th\u1ec3 lo\u1ea1i cha",sortable:true,type:"select",editData:c,valueField:"id",displayField:"name",value:"",width:300},{property:"imageCode",label:"H\u00ecnh \u0111\u1ea1i di\u1ec7n",sortable:true,type:"fileUpload",width:200,multiple:false,acceptFile:".png,.jpg,.jpeg,.gif",onChange:function(b){b=b[0];var d='<ul class="list-unstyled">';d+=String.format('<li class="text-primary" data-code="{0}" data-name="{1}">{1}</li>',BaseUI.generateId(),b.name);this.setEl($(String.format("<span>{0}</ul></span>",
d)))},renderer:function(b){if(!b)return null;return[{uuid:b,name:b,file:b}]}},{label:"",type:"action",separate:"&nbsp;",align:"center",buttons:[{text:"S\u1eeda",icon:"fa fa-pencil",labelCls:"label label-info",fn:function(b){a.grid.edit(b[a.getIdProperties()])}},{text:"X\u00f3a",icon:"fa fa-trash",labelCls:"label label-important",fn:function(b){if(confirm("B\u1ea1n c\u00f3 \u0111\u1ed3ng \u00fd x\u00f3a?")){a.setEntity(b);a.removeRow.call(a,b)}}}]}],delay:100});this.grid=new UI.Grid({id:this.$listItem.prop("id"),
url:this.url.list,dataSource:this.dataSource,idProperty:"id",pageSize:10,remotePaging:true,convertData:function(b){this.setTotal(b.total);return b.data||[]}});UI.ProductCategoryEntity.superclass.constructor.call(this);this.$toolbar.CREATE.on("click",function(){a.clear();a.grid.newRecord()});this.grid.on("save",function(b){a.setEntityId(null);a.setEntity(b);a.save.call(a)});this.grid.on("update",function(b){a.setEntityId(b[a.getIdProperties()]);a.setEntity(b);a.save.call(a)})};BaseUI.extend(UI.ProductCategoryEntity,
UI.Entity,{clear:function(){this.setEntityId(null)},setEntity:function(a){this.entity=a},getEntity:function(){return this.entity},save:function(){var a=this,c=this.getEntity();if(BaseUI.isEmpty(this.getEntityId())){this.setParams(c);this.create(function(b){a.responseHandle(b,function(){a.grid.reload();a.notify("Create success","success");console.log("%cCreate success","color: #00FF00")})})}else{c.id=this.getEntityId();this.setParams(c);this.update(function(b){a.responseHandle(b,function(){a.grid.reload();
a.notify("Update success","success");console.log("%cUpdate success","color: #00FF00")})})}},removeRow:function(a){var c=this;this.setEntityId(a[this.getIdProperties()]);this.setParams(this.getEntity());this.remove(function(b){c.responseHandle(b,function(){c.grid.remove(a[c.getIdProperties()])})})}});new UI.ProductCategoryEntity});