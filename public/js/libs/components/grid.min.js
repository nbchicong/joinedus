$(function(){UI.grid.AbstractColumnManager=function(b){var c=b||{};BaseUI.apply(this,b);this.types={}};BaseUI.extend(UI.grid.AbstractColumnManager,UI.Component,{constructor:UI.grid.AbstractColumnManager,typeName:"type",registerType:function(b,c){this.types[b]=c;c[this.typeName]=b},isRegistered:function(b){return this.types[b]!==undefined},get:function(b){return this.types[b]}});UI.grid.ColumnManager=new UI.grid.AbstractColumnManager});
$(function(){UI.grid.AbstractSearchForm=function(b){var c=b||{};BaseUI.apply(this,c);if(BaseUI.isEmpty(this.id))throw Error("Search ID component must not be null");if(BaseUI.isEmpty(this.url))throw Error("Search URL must not be null");UI.grid.AbstractSearchForm.superclass.constructor.call(this)};BaseUI.extend(UI.grid.AbstractSearchForm,UI.Component,{intComponent:function(){},getUrl:function(){return this.url},getId:function(){return this.id},getEl:function(){return $.getCmp(this.getId())},getData:function(){}})});
$(function(){UI.grid.Column=function(b){b=b||{};this.config={};BaseUI.apply(this,b)};BaseUI.extend(UI.grid.Column,UI.Component,{getGrid:function(){return this.grid},getCellEditor:function(b,c){if(BaseUI.isEmpty(b))throw Error("rowIndex number must not be null");var g=!BaseUI.isEmpty(c)?c:false,i=this.getGrid();return(g?i.getAddControl()||{}:(i.getRowItems().values()[b]||{}).controls||[])[this.getColIndex()]},getCellAdd:function(b){return this.getCellEditor(b,true)},getAction:function(b,c){return this.getCellEditor(b,
c)},setDisabled:function(b){var c=this.getGrid(),g=c.getAddControl()||{},i=g[this.getColIndex()];i.setDisabled(b);c=c.getRowItems();var h=this.getColIndex();c.each(function(k,l){g=l.controls||[];i=g[h];i.setDisabled(b)});this.disabled=b;this.grid.columns[h].disabled=b},enable:function(){this.setDisabled(false)},disable:function(){this.setDisabled(true)},hide:function(){this.hidden=true;this.grid.columns[this.getColIndex()].hidden=true},getColIndex:function(){return this.colIndex},getType:function(){return this.type},
getProperty:function(){return this.property},getConfig:function(){return this.config},setEditData:function(b){this.editData=b||[];var c=this.getGrid(),g=c.getAddControl()||{},i=g[this.getColIndex()];i.column.editData=this.editData;i.edit();c=c.getRowItems();var h=this.getColIndex();c.each(function(k,l){g=l.controls||[];i=g[h];i.column.editData=this.editData});this.grid.columns[this.getColIndex()].editData=b||[]}})});
$(function(){UI.grid.ColumnModel=function(b){b=b||{};BaseUI.apply(this,b);this.columns=BaseUI.clone(this.grid.columns)||[]};BaseUI.extend(UI.grid.ColumnModel,UI.Component,{getColumnById:function(b){return(this.getGrid().getAddControl()||[])[b].getColumn()},getColumnByName:function(b){for(var c in this.columns){var g=this.columns[c];if(g.property==b)return(this.getGrid().getAddControl()||[])[c].getColumn()}return null},setColumns:function(b){this.columns=b},getColumns:function(){return this.columns},
getGrid:function(){return this.grid}})});BaseUI.ns("UI.grid.DataSource");
(function(b,c){b.DataSource=c();b.UI.grid.DataSource=b.DataSource})(this,function(){var b=function(c){this._formatter=c.formatter;this._columns=c.columns||[];this._delay=c.delay||0;this._filterProp=c.filterProperty;this._idProp=c.idProperty;this._store=new Hashtable};b.prototype={setIdProperty:function(c){this._idProp=c},getIdProperty:function(){return this._idProp},columns:function(){return this._columns},getStore:function(){return this._store},setData:function(c){c=c||[];var g=this,i=g.getStore();
i.clear();_.filter(c,function(h){if(BaseUI.isEmpty(h[g.getIdProperty()]))h[g.getIdProperty()]=BaseUI.generateId().toString();i.put(h[g.getIdProperty()].toString(),h)})},getData:function(){return this.getStore().values()},insert:function(c){var g=c||{};if(BaseUI.isEmpty(g[this.getIdProperty()]))g[this.getIdProperty()]=BaseUI.generateId().toString();this.getStore().put(g[this.getIdProperty()].toString(),g)},remove:function(c){var g=c.toString().split(";");c=this.getStore();for(var i=0,h=0;h<g.length;h++)if(c.remove(g[h]))i+=
1;return i},update:function(c){var g=this.getStore(),i=c||{};return g.put(i[this.getIdProperty()].toString(),i)},count:function(){return this.getStore().size()},data:function(c,g){var i=this,h=!BaseUI.isEmpty(c.count);c.pageSize=c.pageSize||10;setTimeout(function(){var k=$.extend(true,[],i.getData());if(c.search)k=_.filter(k,function(t){var y=false;_.each(t,function(z){if(_.isString(z)||_.isFinite(z))if(z.toString().toLowerCase().indexOf(c.search.toLowerCase())!==-1)y=true});return y});if(c.filter)k=
_.filter(k,function(t){if(c.filter.value==t[i._filterProp])return true;else if(c.filter.value=="")return true;return false});var l=h?c.count:k.length;if(c.sortProperty){k=_.sortBy(k,c.sortProperty);c.sortDirection==="desc"&&k.reverse()}var o=c.pageIndex*c.pageSize,p=o+c.pageSize,r=p>l?l:p,u=Math.ceil(l/c.pageSize),x=c.pageIndex+1,v=o+1;if(!h){k=k.slice(o,p);i._formatter&&i._formatter(k)}g({data:k,start:v,end:r,count:l,pages:u,page:x})},this._delay)}};return b});
$(function(){UI.grid.Editor=function(b){b=b||{};BaseUI.apply(this,b)};BaseUI.extend(UI.grid.Editor,UI.Component,{getData:function(){},isLoaded:function(){return this.getEl().data("loaded")},setLoaded:function(b){this.getEl().data("loaded",b)},setDisabled:function(b){this.getEl().prop("disabled",b)},getDisabled:function(){return this.getEl().prop("disabled")},setValue:function(){},getValue:function(){return null},getColumn:function(){return this.column},render:function(){},edit:function(){},insert:function(b){return this.edit(b)},
focus:function(){this.getEl().focus()},setEl:function(b){var c=this.getCell();if(this.getCell()){c.empty();this.$cell=c.append(b);this.$el=b;return this.$cell}},getEl:function(){return this.$el},getCell:function(){return this.$cell.length>0?this.$cell:$(this.getEl().get(0)).parent()},getRow:function(){return this.getCell().parent()},getRecordId:function(){return this.getRow().attr("data-id")},getRecord:function(){return this.getGrid().getById(this.getRecordId())},getGrid:function(){return this.grid},
isValid:function(b){var c=b||this.getValue(),g=this.getColumn(),i=g.validate||BaseUI.emptyFn,h=i(c),k=BaseUI.isEmpty(h);k?this.clearError():this.setError(h);return k},setError:function(b){var c=this.getEl();c.addClass("tooltip-error error").attr("title",b);c.tooltip()},clearError:function(){var b=this.getEl();b.removeClass("tooltip-error error").attr("title","");b.tooltip("destroy")},setIndexOfRow:function(b){this.rowIndex=b},getIndexOfRow:function(){return this.rowIndex}})});
$(function(){UI.Grid=function(b){b=b||{};this.prefix=b.prefix?b.prefix:b.id;this.id=this.id||"grid";BaseUI.apply(this,{displayMsg:this.displayMsg||"Displaying <b>{0}</b> - <b>{1}</b> of <b>{2}</b>",emptyMsg:this.emptyMsg||"No data to display",beforePageText:this.beforePageText||"Page",afterPageText:this.afterPageText||"of {0}",firstText:this.firstText||"First Page",prevText:this.prevText||"Previous Page",nextText:this.nextText||"Next Page",lastText:this.lastText||"Last Page",refreshText:this.refreshText||
"Refresh",searchText:this.searchText||"Search",searchPlaceholder:this.searchPlaceholder||"Keyword",downloadText:this.downloadText||"Download"});BaseUI.apply(this,b);this.prefix=this.prefix?this.prefix+"-":"";this.containerId=String.format("#{0}",this.id);this.gridId=String.format("#{0}-table-main",this.id);this.options=b;this.options.dataOptions={pageIndex:this.pageIndex||0,pageSize:this.pageSize||BaseUI.pageSize||10,count:this.total,sortDirection:this.sortDirection,sortProperty:this.sortProperty};
this.options.addable=BaseUI.isBoolean(this.options.addable)?this.options.addable:false;this.options.editable=BaseUI.isBoolean(this.options.editable)?this.options.editable:false;this.options.offFocus=BaseUI.isBoolean(this.options.offFocus)?this.options.offFocus:false;this.options.loadingHTML='<div class="progress progress-striped active" style="width:50%;margin:auto;"><div class="bar progress-bar progress-bar-success" style="width:100%;"></div></div>';this.options.itemsText=this.itemsText;this.options.itemText=
this.itemText;this.element=this.gridId;this.store=new Hashtable;this.onSave=this.onSave||BaseUI.emptyFn;this.onUpdate=this.onUpdate||BaseUI.emptyFn;this.firstLoad=!BaseUI.isEmpty(this.firstLoad)?this.firstLoad:true;this.disabled=!BaseUI.isEmpty(this.disabled)?this.disabled:false;this.hidden=!BaseUI.isEmpty(this.hidden)?this.hidden:false;this.height=!BaseUI.isEmpty(this.height)?this.height+"px":"auto";this.enableSelection=!BaseUI.isEmpty(this.enableSelection)?this.enableSelection:false;this.remotePaging=
!BaseUI.isEmpty(this.remotePaging)?this.remotePaging:false;this.hideSearch=!BaseUI.isEmpty(this.hideSearch)?this.hideSearch:false;this.hideHeader=!BaseUI.isEmpty(this.hideHeader)?this.hideHeader:false;this.autoHideAdv=!BaseUI.isEmpty(this.autoHideAdv)?this.autoHideAdv:false;this.allowUpdate=this.allowSave=false;this.submitType=!BaseUI.isEmpty(this.submitType)?this.submitType:"get";this.allowDownload=!BaseUI.isEmpty(this.allowDownload)?this.allowDownload:false;this.stretchHeight=!BaseUI.isEmpty(this.stretchHeight)?
this.stretchHeight:false;this.basicSearch=this.basicSearch?this.basicSearch:null;this.advanceSearch=this.advanceSearch?this.advanceSearch:null;this.rowClass=BaseUI.isFunction(this.rowClass)?this.rowClass:null;this.moveLastOnInsert=!BaseUI.isEmpty(this.moveLastOnInsert)?this.moveLastOnInsert:false;this.rowItems=new Hashtable;this.listUpdate=[];this.pageProperty=this.pageProperty||"pageNumber";this.version="2.0";var c=this,g=this.getEl();g.addClass("fuelux");this.$basicSearch=[];this.$advanceSearch=
[];if(this.basicSearch&&BaseUI.isFunction(this.basicSearch)){this.quickSearch=new this.basicSearch;this.quickSearch.keydownEnabled=!BaseUI.isEmpty(this.quickSearch.keydownEnabled)?this.quickSearch.keydownEnabled:true;this.quickSearch.search=BaseUI.isFunction(this.search)?this.search:function(){c.setParams(c.quickSearch.getData());c.setUrl(c.quickSearch.getUrl()||c.quickSearch.url);c.reload()};this.$basicSearch=$("#"+this.quickSearch.getId()||this.quickSearch.id);this.$basicSearch.find("div:first").prop("id",
this.quickSearch.getId())}if(this.advanceSearch&&BaseUI.isFunction(this.advanceSearch)){this.advSearch=new this.advanceSearch;this.advSearch.keydownEnabled=!BaseUI.isEmpty(this.advSearch.keydownEnabled)?this.advSearch.keydownEnabled:true;this.$advanceSearch=$("#"+this.advSearch.getId()||this.advSearch.id);this.advSearch.search=this.search&&BaseUI.isFunction(this.search)?this.search:function(){c.setParams(c.advSearch.getData());c.setUrl(c.advSearch.getUrl()||c.advSearch.url);c.reload()}}(function(){var h=
String.format('<table id="{0}-grid-header" class="table datagrid grid-header hidden-480 {1}">',c.id,c.hideHeader?"xhide":"");h+='<thead><tr><th><div class="col-xs-12 col-md-12 row-fluid nopadding">';if(!c.hideSearch){h+='<div class="datagrid-header-left nopadding col-md-7 col-xs-7 span6">';if(c.$basicSearch.length>0){h+=c.$basicSearch.html();c.$basicSearch.remove()}else{h+='<div class="col-xs-6 col-md-6 span6 nopadding" style="max-height: 30px;"><span class="input-group search" style="margin-left:0px;width: 250px">';
h+='<span class="input-group-btn">';h+=String.format('<input type="text" class="grid-search-input form-control" placeholder="{0}">',c.searchPlaceholder);h+='<button type="button" class="btn btn-default grid-search-btn"><i class="fa fa-search"></i></button></span></span></div>'}h+="</div>"}var k=c.hideSearch?"col-xs-12 col-md-12 span12":"col-md-5 col-xs-5 span6",l=c.hideSearch?"hidden-320":"hidden-767";h+=String.format('<div class="datagrid-header-right hidden-320 nopadding {0}">',k);h+=String.format('<span class="paging {0}">',
l);h+=String.format(c.displayMsg,'<span class="grid-start">0</span>','<span class="grid-end">0</span>','<span class="grid-count">0</span>&nbsp;</span>');h+=String.format('<button type="button" class="btn grid-firstpage first" title="{0}"><i class="fa fa-step-backward"></i></button>',c.firstText);h+=String.format('<button type="button" class="btn grid-prevpage" title="{0}"><i class="fa fa-chevron-left"></i></button>',c.prevText);h+=String.format('<input class="grid-page" type="text" />');h+=String.format('<button type="button" class="btn grid-nextpage" title="{0}"><i class="fa fa-chevron-right"></i></button>',
c.nextText);h+=String.format('<button type="button" class="btn grid-lastpage" title="{0}"><i class="fa fa-step-forward"></i></button>',c.lastText);if(c.allowDownload)h+=String.format('<button type="button" class="btn grid-download" title="{0}"><i class="fa fa-download-alt"></i></button>',c.downloadText);h+=String.format('<button type="button" class="btn grid-refresh last" title="{0}"><i class="fa fa-refresh"></i></button>',c.refreshText);h+="</div>";h+="</div></th></tr></thead></table>";var o=String.format('<div style="height: {1}; width: 100%;background-color: #F9F9F9;">',
c.id,c.height);o+=String.format('<table id="{0}-table-main" class="table table-bordered datagrid grid table-striped">',c.id);o+="<colgroup></colgroup><thead></thead></table></div>";g.html(h+o)})();if(this.quickSearch){this.quickSearch.intComponent(this);b=g.find("#"+this.quickSearch.getId());var i=b.find("[data-expand-hide=true]");b.find("[data-action-search]").click(function(){switch($(this).attr("data-action-search")){case "expand":i.hide();c.$advanceSearch.show(0,function(){c.fireEvent("expandadvance",
c.advSearch,c.quickSearch)});break;case "search":c.quickSearch.search()}});this.quickSearch.keydownEnabled&&b.off("keydown","input").on("keydown","input",function(h){(h.keyCode?h.keyCode:h.which)==13&&c.quickSearch.search()})}if(this.advSearch){this.advSearch.intComponent(this);this.$advanceSearch.find("[data-action-search]").click(function(){switch($(this).attr("data-action-search")){case "close":i.show();c.$advanceSearch.hide(0,function(){c.fireEvent("closeadvance",c.advSearch,c.quickSearch)});
break;case "search":c.advSearch.search();if(c.autoHideAdv){i.show();c.$advanceSearch.hide(0,function(){c.fireEvent("closeadvance",c.advSearch,c.quickSearch)})}}});this.advSearch.keydownEnabled&&this.$advanceSearch.off("keydown","input").on("keydown","input",function(h){(h.keyCode?h.keyCode:h.which)==13&&c.search()})}this.$element=$(this.element);this.$colgroup=this.$element.find("colgroup");this.$thead=this.$element.find("thead");this.$topheader=this.$element.find("thead th");this.$pagingContent=
$(String.format("#{0}-grid-header",this.id));this.$searchcontrol=this.$pagingContent.find(".search");this.$filtercontrol=this.$pagingContent.find(".filtering");this.$prevpagebtn=this.$pagingContent.find(".grid-prevpage");this.$nextpagebtn=this.$pagingContent.find(".grid-nextpage");this.$pageinput=this.$pagingContent.find("input.grid-page");this.$firstpagebtn=this.$pagingContent.find(".grid-firstpage");this.$lastpagebtn=this.$pagingContent.find(".grid-lastpage");this.$refreshbtn=this.$pagingContent.find(".grid-refresh");
this.$downloadbtn=this.$pagingContent.find(".grid-download");this.$pageslabel=this.$pagingContent.find(".grid-pages");this.$countlabel=this.$pagingContent.find(".grid-count");this.$startlabel=this.$pagingContent.find(".grid-start");this.$endlabel=this.$pagingContent.find(".grid-end");this.$tbody=$("<tbody>").insertAfter(this.getHeader());this.$colheader=$("<tr>").appendTo(this.getHeader());this.dataSource&&this.dataSource.setIdProperty(this.getIdProperty());this.columns=this.dataSource?this.dataSource.columns():
[];this.sm=null;this.resized=false;this.$pageinput.height(18);this.$pageinput.on("change",$.proxy(this.pageChanged,this));this.$nextpagebtn.on("click",$.proxy(this.next,this));this.$prevpagebtn.on("click",$.proxy(this.previous,this));this.$firstpagebtn.on("click",$.proxy(this.first,this));this.$lastpagebtn.on("click",$.proxy(this.last,this));this.$refreshbtn.on("click",$.proxy(this.load,this));this.$downloadbtn.on("click",$.proxy(this.download,this));this.$searchcontrol.on("searched cleared",$.proxy(this.searchChanged,
this));this.$filtercontrol.on("changed",$.proxy(this.filterChanged,this));this.$colheader.on("click","th",$.proxy(this.headerClicked,this));this.$element.on("loaded",function(){c.isEdit()&&c.editAll();c.isAdd()&&c.newRecord();if(c.enableSelection){c.sm=new UI.grid.CheckboxSelection({grid:c});c.sm.on("selectionchange",function(h,k){c.fireEvent("selectionchange",h,k)})}else c.sm=new UI.grid.ClickSelection;if(!c.resized){c.fireEvent("resize",c);c.resized=true}c.fireEvent("loaded",c.getStore())});this.renderColumns();
if(this.stretchHeight){this.initStretchHeight();$(window).resize(function(){c.fireEvent("resize",c)})}if(this.firstLoad){if(this.quickSearch){this.setParams(this.quickSearch.getData());this.setUrl(this.quickSearch.getUrl()||this.quickSearch.url)}else if(BaseUI.isEmpty(this.url))throw Error("Missing url");this.load()}else{if(!BaseUI.isEmpty(this.url)||!BaseUI.isEmpty(this.data))this.loadData(BaseUI.isFunction(this.data)?this.data():this.data||[]);this.isAdd()&&this.newRecord()}this.hidden&&this.hide()};
BaseUI.extend(UI.Grid,UI.Component,{constructor:UI.Grid,version:"2.1",setDataSource:function(b){this.dataSource=b;this.dataSource.setIdProperty(this.getIdProperty());this.columns=this.dataSource.columns();this.getColumnModel().setColumns(this.columns);this.renderColumns();this.renderData()},loadData:function(b){var c=b||[];if(this.dataSource!=null){this.dataSource.setData(c);this.renderData()}},clearData:function(){if(this.dataSource!=null){this.options.dataOptions.count=null;this.dataSource.setData([]);
this.renderData()}return true},_initHeader:function(){var b="",c="",g=$('<tr onclick="javascript:;" data-action="new" style="display:none"></tr>'),i=this.getColumnModel().getColumns();this.$topheader.attr("colspan",i.length);this.addControls=[];for(var h=0;h<i.length;h++){var k=i[h]||{},l=k.cls||"",o=BaseUI.isNumber(k.width)?k.width+"px":"auto";if(k.type=="action"){var p=k.buttons||[],r=p.length*40+"px";b+=String.format('<col style="width:{0}" class="{1}"/>',r,l)}else b+=String.format('<col style="width:{0}" class="{1}" />',
o,l);if(k.type=="selection"){this.enableSelection=true;c+=String.format('<th style="text-align:center;vertical-align:middle" class="{0}"><label><input style="width:auto;display: inline;" type="checkbox" class="ace"/><span class="lbl"></span></label></th>',l)}else{c+=String.format('<th data-property="{0}" class="{1} {2}" style="max-width: {3}"',k.property||"",k.sortable?"sortable":"",l,o);c+=">"+(k.label||"")+"</th>"}var u=k.align||"left",x=$(String.format('<td class="newrecord {1}" style="text-align:{0};vertical-align:middle;"></td>',
u,l)),v=null,t=BaseUI.clone(k);t.grid=this;t.colIndex=h;t={grid:this,column:new UI.grid.Column(t),$cell:x};if(k.editor){v=new k.editor(t);v.insert()}else{var y=null;if(y=UI.grid.ColumnManager.isRegistered(k.type)?UI.grid.ColumnManager.get(k.type):UI.grid.ColumnManager.get("label")){v=new y(t);v.insert()}}this.addControls.push(v);g.append(x)}return{$thead:g,colHTML:c,colGroup:b}},_switchView:function(b){var c=b||{},g=this.getColumnModel().getColumns(),i=c[this.getIdProperty()].toString();b=this.findRowById(i);
var h=this.getRowItems().get(i);if(h){var k=h.controls||[];for(h=0;h<k.length;h++){var l=k[h];if(BaseUI.isObject(l)){var o=l.getColumn();if(o){var p=c[o.getProperty()];p=!BaseUI.isEmpty(p)?p:o.value;l.getCell().removeClass("editable");var r=!BaseUI.isEmpty(p)?p:"";if(!BaseUI.isEmpty(o.renderer)&&BaseUI.isFunction(o.renderer))p=o.renderer(r,c,h);l.render(p,c);var u=this.rowClass?this.rowClass(c):"";l.setIndexOfRow(b.index());l.getRow().attr("class",u)}}}}else{b.empty();var x=[];k=[];for(h=0;h<g.length;h++){l=
g[h];var v=l.align||"left",t=l.valign||"top",y=l.cls||"",z=$(String.format('<td style="text-align:{0};vertical-align:{1}" class="{2}">',v,t,y));p=c[l.property];var A=BaseUI.clone(l);A.grid=this;A.colIndex=h;var w=null;A={grid:this,column:new UI.grid.Column(A),$cell:z};if(l.editor){w=new l.editor(A);w.setIndexOfRow(b.index()||h);w.render(p)}else{r=!BaseUI.isEmpty(p)?p:"";if(!BaseUI.isEmpty(l.renderer)&&BaseUI.isFunction(l.renderer))p=l.renderer(r,c,h);if(l=UI.grid.ColumnManager.isRegistered(l.type)?
UI.grid.ColumnManager.get(l.type):UI.grid.ColumnManager.get("label")){w=new l(A);w.setIndexOfRow(b.index());w.render(p,c)}}w&&x.push(w);u=this.rowClass?this.rowClass(c):"";b.attr("class",u);k.push(z)}b.append(k);this.rowItems.put(i.toString(),{rowIndex:b.index(),controls:x})}this.removeListenerOutsideEvent(b)},_switchEdit:function(b){var c=b||{},g=c[this.getIdProperty()].toString();b=this.findRowById(g);for(var i=(this.getRowItems().get(g)||{}).controls||[],h=false,k=0;k<i.length;k++){var l=i[k];
if(BaseUI.isObject(l)){var o=l.getColumn();if(o){var p=c[o.getProperty()];p=!BaseUI.isEmpty(p)?p:o.value;if(!BaseUI.isEmpty(o.renderer)&&BaseUI.isFunction(o.renderer))p=o.renderer(p,c,k);var r=l.getCell();r.empty();r.addClass("editable");r.append(l.edit(p));if(!h&&o.type!="selection"){l.focus();h=true}}}}this.fireEvent("beforeedit",c,b.index());this.listenerOutsideEvent(b)},getAddControl:function(){return this.addControls},getRowItems:function(){return this.rowItems},renderColumns:function(){var b=
this._initHeader(),c=b.$thead;this.$colgroup.html(b.colGroup);this.getHeader().parent().find("colgroup").html(b.colGroup);this.$colheader.html(b.colHTML);this.getHeader().find("tr:gt(0)").remove();this.getHeader().append(c);BaseUI.isEmpty(this.options.dataOptions.sortProperty)||this.updateColumns(this.getHeader().find(String.format('th[data-property="{0}"]:last',this.options.dataOptions.sortProperty)),this.options.dataOptions.sortDirection)},addEvent:function(){var b=this;this.$element.trigger("loaded");
b.$tbody.off("click","tr[data-id] td:not([data-action])").on("click","tr[data-id] td:not([data-action])",function(){var c=$($(this).parent()),g=c.attr("data-id"),i=$(this).hasClass("editable");if(!BaseUI.isEmpty(g)){var h=b.store.get(g)||{},k=b.getSelectionModel();if(b.enableSelection)c.hasClass("selected")||k.checkedRow(c,true);else{if(c.hasClass("selected")){c.removeClass("selected");k.clearSelection()}else{b.$tbody.find("tr[data-id]").removeClass("selected");c.addClass("selected");k.setSelection([h])}b.fireEvent("selectionchange",
k,h)}b.hasEvent("click")&&b.fireEvent("click",h,i,$(this))}})},updateColumns:function(b,c){var g=c==="asc"?"fa fa-chevron-up":"fa fa-chevron-down";this.$colheader.find("i").remove();this.$colheader.find("th").removeClass("sorted");$("<i>").addClass(g).appendTo(b);b.addClass("sorted")},updatePageButtons:function(b){this.paging=b||{};var c=b.page<=1,g=b.page>=b.pages||b.count<1;this.$prevpagebtn.prop("disabled",c);this.$nextpagebtn.prop("disabled",g);this.$firstpagebtn.prop("disabled",c);this.$lastpagebtn.prop("disabled",
g);this.$downloadbtn.prop("disabled",b.count<1)},_switchEditAll:function(){var b=this,c=this.getStore();c.each(function(g,i){b._switchEdit(i)});this.refreshSelection()},_switchViewAll:function(){var b=this;this.rowItems.clear();var c=this.getStore();c.each(function(g,i){b._switchView(i)});this.refreshSelection()},refreshSelection:function(){var b=this.getSelectionModel();b&&this.enableSelection&&b.clearSelected()},renderData:function(b){this.fireEvent("beforeload",this);var c=this,g=b||BaseUI.emptyFn;
this._setAllowUpdate(false);this.store.clear();this.getBody().html(this.placeholderRowHTML(this.options.loadingHTML));var i="";this.dataSource.data(this.options.dataOptions,function(h){if(c.options.dataOptions.pageIndex>h.page)c.options.dataOptions.pageIndex=0;c.$pageslabel.text(h.pages);c.$countlabel.text(h.count);if(h.count<1){c.$startlabel.text(0);c.$pageinput.val(0).prop("disabled",true)}else{c.$startlabel.text(h.start);c.$pageinput.val(c.options.dataOptions.pageIndex+1).prop("disabled",false)}c.$endlabel.text(h.end);
c.updatePageButtons(h);var k=h.data||[];for(h=0;h<k.length;h++){var l=k[h]||{},o=l[c.getIdProperty()];c.store.put(o.toString(),l);l[c.getIdProperty()]=o;i+=String.format('<tr onclick="javascript:;" data-id="{0}"></tr>',o)}i||(i=c.placeholderRowHTML(c.emptyMsg));c.$tbody.html(i);c._switchViewAll();c.stretchHeightFn();c.addEvent();g()})},placeholderRowHTML:function(b){var c=0;c=this.isVisible()?this.getHeader().find("tr:first").find("th:visible").length:this.columns.length;c=c<1?this.columns.length:
c;return String.format('<tr><td style="padding:10px;border-bottom:none;" colspan="{0}"><i>{1}</i></td></tr>',c,b)},headerClicked:function(b){b=$(b.target);if(b.hasClass("sortable")){var c=this.options.dataOptions.sortDirection,g=this.options.dataOptions.sortProperty,i=b.data("property");if(g===i)this.options.dataOptions.sortDirection=c==="asc"?"desc":"asc";else{this.options.dataOptions.sortDirection="asc";this.options.dataOptions.sortProperty=i}if(!this.remotePaging)this.options.dataOptions.pageIndex=
0;this.updateColumns(b,this.options.dataOptions.sortDirection);this.renderData()}},sort:function(b,c){this.options.dataOptions.sortProperty=b;this.options.dataOptions.sortDirection=c||"asc";this.updateColumns(this.getHeader().find(String.format('th[data-property="{0}"]:last',b)),this.options.dataOptions.sortDirection);this.renderData()},pagesizeChanged:function(b,c){this.options.dataOptions.pageSize=c?parseInt(c.value,10):parseInt($(b.target).val(),10);this.options.dataOptions.pageIndex=0;this.renderData()},
pageChanged:function(b){b=$(b.target);var c=parseInt(b.val(),10)||1;c=BaseUI.isEmpty(c)?1:c;var g=this.paging.pages;this.options.dataOptions.pageIndex=c>g?g-1:c-1;b.val(this.options.dataOptions.pageIndex+1);if(this.remotePaging){var i=this.getParams();i[this.getPageProperty()]=this.options.dataOptions.pageIndex;this.setParams(i);this.load()}else this.renderData()},searchChanged:function(b,c){this.options.dataOptions.search=c;this.options.dataOptions.pageIndex=0;this.renderData()},filterChanged:function(b,
c){this.options.dataOptions.filter=c;this.renderData()},goPage:function(b){var c=b||0;this.options.dataOptions.pageIndex=c;if(this.remotePaging){var g=this.getParams();g[this.getPageProperty()]=this.options.dataOptions.pageIndex;this.setParams(g);console.log(this.getParams());this.load()}else this.renderData()},previous:function(){if(!(this.paging.page<=1)){this.options.dataOptions.pageIndex--;this.goPage(this.options.dataOptions.pageIndex)}},next:function(){if(!(this.paging.page>=this.paging.pages)){this.options.dataOptions.pageIndex++;
this.goPage(this.options.dataOptions.pageIndex)}},first:function(){this.goPage(0)},last:function(){this.goPage(this.paging.pages-1)},reload:function(){this.options.dataOptions.pageIndex=0;this.load()},initStretchHeight:function(){this.$gridContainer=this.$element.parent();var b="border-left: 0px;border-right: 0px;border-bottom:0px;";if(BaseUI.isGecko)b="border-left-color: transparent;border-right-color: transparent;border-bottom-color:transparent;";this.$element.wrap(String.format('<div class="datagrid-stretch-wrapper" style="overflow-x:auto;overflow-y:scroll;{0}">',
b));this.$stretchWrapper=this.$element.parent();this.$headerTable=$("<table>").attr("class",this.$element.attr("class"));this.$headerTable.append(this.$colgroup.clone());this.$headerTable.prependTo(this.$gridContainer).addClass("datagrid-stretch-header");this.getHeader().detach().appendTo(this.$headerTable);$(this.$headerTable).wrap(String.format('<div style="margin-right:{0}px;overflow: hidden;border-right: 1px solid transparent;" />',$.getScrollBarWidth()));var c=this.$pagingContent.width()+"px";
if(BaseUI.isGecko){this.$headerTable.css({width:c,"table-layout":"fixed","border-color":"transparent"});this.$headerTable.find("th:first,td:first").css({"border-left-color":"transparent"});this.$headerTable.find("th:last").css({"border-right-color":"transparent"})}else{this.$headerTable.css({width:c,"table-layout":"fixed",border:"0px"});this.$headerTable.find("th:first,td:first").css({"border-left-color":"transparent"})}this.$element.css({width:c,"table-layout":"fixed"});this.$pagingContent.css({"border-bottom":"1px solid #DDD"});
this.getEl().attr("style","border:1px solid #DDD;");this.$sizingHeader=this.getHeader().clone();this.$sizingHeader.find("tr:first").remove();this.$stretchWrapper.scroll(function(){$(this.$headerTable.parent()).get(0).scrollLeft=this.$stretchWrapper.get(0).scrollLeft}.createDelegate(this));$(this.$headerTable.parent()).scroll(function(){$(this.$headerTable.parent()).get(0).scrollLeft=this.$stretchWrapper.get(0).scrollLeft}.createDelegate(this))},stretchHeightFn:function(){if(this.$gridContainer){var b=
this.$gridContainer.height(),c=this.$headerTable.outerHeight();this.$stretchWrapper.height(b-c-(this.isAdd()?20:0))}},disable:function(){this.setDisabled(true)},enable:function(){this.setDisabled(false)},setDisabled:function(b){this.disabled=!!b;this.getEl().find("input,select,button").prop("disabled",this.disabled)},isDisabled:function(){return this.disabled},hide:function(){this.setVisible(false)},show:function(){this.setVisible(true)},setVisible:function(b){(this.hidden=!b)?this.getEl().hide():
this.getEl().show()},isVisible:function(){return!this.hidden&&this.getEl().is(":visible")},save:function(b){var c={},g=(b||"").toString();if(BaseUI.isEmpty(g)){b=this.getAddControl();var i={};for(h=0;h<b.length;h++){k=b[h];if(!BaseUI.isEmpty(k.column)){l=k.getColumn();if(!BaseUI.isEmpty(l.getProperty())){o=k.getValue();if(k.isValid(o))i[l.getProperty()]=o;else{k.focus();return}}}}this.hasEvent("save")?this.fireEvent("save",i):this.onSave(i);this._setAllowSave(false)}else{b=this.getRowItems().get(g).controls;
for(var h=0;h<b.length;h++){var k=b[h];if(!BaseUI.isEmpty(k)){var l=k.getColumn();if(!BaseUI.isEmpty(l.getProperty())){var o=k.getValue();if(k.isValid(o))c[l.getProperty()]=o;else{k.focus();return}}}}var p=this.getById(g);c[this.getIdProperty()]=p[this.getIdProperty()];this.hasEvent("update")?this.fireEvent("update",c,p):this.onUpdate(c,p);this._setAllowUpdate(false)}},findRowById:function(b){if(!BaseUI.isEmpty(b)){var c=b.toString().split(";"),g=[];for(b=0;b<c.length;b++)g.push(String.format('tr[data-id="{0}"]',
c[b]));return this.getBody().find(g.join(","))}},selectById:function(b,c){var g=this.findRowById(b),i=this.getSelectionModel();if(this.enableSelection)i.checkedRow(g,c);else{var h=this.getById(b);if(!g.hasClass("selected")){this.getBody().find("tr[data-id]").removeClass("selected");g.addClass("selected")}i.setSelection([h]);this.fireEvent("selectionchange",i,h)}},changeCell:function(b){if(!b)throw Error("Editor must not be null");var c=b.getRecordId(),g={},i={};this._setAllowUpdate(!BaseUI.isEmpty(c));
if(BaseUI.isEmpty(c))for(var h=this.getAddControl(),k=0;k<h.length;k++){var l=h[k];if(!BaseUI.isEmpty(l.column)){var o=l.getColumn();if(!BaseUI.isEmpty(o.getProperty())){var p=l.getValue();if(l.isValid(p))g[o.getProperty()]=p;else{l.focus();return}}}}else{h=this.getRowItems().get(c.toString()).controls;for(k=0;k<h.length;k++){l=h[k];if(!BaseUI.isEmpty(l)){o=l.getColumn();if(!BaseUI.isEmpty(o.getProperty())){p=l.getValue();if(l.isValid(p))g[o.getProperty()]=p;else{l.focus();return}}}}i=this.getById(c);
g[this.getIdProperty()]=i[this.getIdProperty()]}this.fireEvent("change",i,g,b.getColumn().getColIndex(),b.getRow().index())},clickCell:function(b){b&&this.fireEvent("controlclick",b.getRecord(),b.getColumn().getColIndex(),b.getRow().index())},endEdit:function(){BaseUI.isEmpty(this.currentEditId)||this.save(this.currentEditId)},cancelEdit:function(){BaseUI.isEmpty(this.currentEditId)||this.cancel(this.currentEditId)},getHeader:function(){return this.$thead},getNewRow:function(){return this.getHeader().find('tr[data-action="new"]')},
newRecord:function(b){var c=b||{};this.setAddable(true);this._setAllowSave(true);b=this.getAddControl();var g=this.getNewRow();g.show();for(var i=false,h=0;h<b.length;h++){var k=b[h];if(!BaseUI.isEmpty(k.column)){var l=k.getColumn(),o=c[l.getProperty()];o=!BaseUI.isEmpty(o)?o:l.value;k.setValue(!BaseUI.isEmpty(o)?o:"");k.clearError();if(!i&&l.type!="selection"){k.focus();i=true}}}this.disabled&&this.disable();this.listenerOutsideEvent(g);this.stretchHeightFn()},hideNewRecord:function(){this.getNewRow().hide();
this.setAddable(false);this._setAllowSave(false);this.stretchHeightFn()},isValid:function(){return true},insert:function(b){var c=b||{},g=this,i=this.getById(c[this.getIdProperty()]);if(!i){this.dataSource.insert(c);if(this.remotePaging)BaseUI.isEmpty(this.getTotal())?this.setTotal(null):this.setTotal((this.getTotal()||0)+1);else this.remotePaging||this.setTotal(null);this.moveLastOnInsert?this.renderData(function(){g.fireEvent("insert",i);g.last()}):this.renderData(function(){g.fireEvent("insert",
i)});return true}return false},update:function(b){var c=b||{},g=this.dataSource.update(c);if(g){this.getStore().put(c[this.getIdProperty()].toString(),c);this.listUpdate.push(c);return true}return false},commit:function(){for(var b=[],c=0;c<this.listUpdate.length;c++){var g=this.listUpdate[c]||{};this._switchView(g);this.refreshSelection();b.push(g[this.getIdProperty()])}this.getSelectionModel().refresh();b.length>0&&this.selectById(b.join(";"),false);this.listUpdate=[]},getById:function(b){var c=
b||"";if(!BaseUI.isEmpty(c))return this.store.get(c.toString())},getStore:function(){return this.store},remove:function(b){var c=b||"",g=this,i=false;if(BaseUI.isEmpty(c))return i;var h=this.dataSource.remove(c);this.remotePaging&&this.setTotal(this.dataSource.count());this.renderData(function(){g.getSelectionModel().clearSelected()});return!!h},clear:function(){this.clearData()},edit:function(b){var c=b||"";if(!BaseUI.isEmpty(c)){this.currentEditId=c;this._switchEdit(this.getById(c));this.refreshSelection();
var g=this.findRowById(c);this.disabled&&this.disable();this.selectById(b,true);return g}},cancel:function(b){var c=b||"";if(BaseUI.isEmpty(c))this.hideNewRecord();else{this._setAllowUpdate(false);this._switchView(this.getById(c));this.refreshSelection();return true}},load:function(){var b=this,c=this.getParams()||{};this.getBody().html(this.placeholderRowHTML(this.options.loadingHTML));if(this.dataSource){this.$pagingContent.show();b.fireEvent("beforesubmit",c);if(BaseUI.isEmpty(b.url))b.renderData();
else if(b.submitType=="post")$.postJSON(b.url,c,function(g){var i=g||{},h=BaseUI.isFunction(b.convertData)?b.convertData(i):i.data;b.dataSource.setData(h||[]);b.renderData()});else b.submitType=="get"&&$.getJSON(b.url,c,function(g){var i=g||{},h=BaseUI.isFunction(b.convertData)?b.convertData(i):i.data;b.dataSource.setData(h||[]);b.renderData()})}else{this.getBody().html(b.placeholderRowHTML(b.emptyMsg));this.$pagingContent.hide()}},download:function(){this.fireEvent("download",this.getParams(),this)},
setPageIndex:function(b){this.options.dataOptions.pageIndex=b||0},getPageIndex:function(){return this.options.dataOptions.pageIndex},getPageSize:function(){return this.options.dataOptions.pageSize},setTotal:function(b){this.options.dataOptions.count=b},getTotal:function(){return this.options.dataOptions.count},setParams:function(b){this.params=b||{}},getParams:function(){return this.params||{}},setUrl:function(b){this.url=b||""},getUrl:function(){return this.url},getBody:function(){return this.$tbody},
isEdit:function(){return this.options.editable},hasEdit:function(){return this.getBody().find("td").hasClass("editable")},setEditable:function(b){this.options.editable=b},isAdd:function(){return this.options.addable},setAddable:function(b){this.options.addable=b},editAll:function(){this.setEditable(true);this._switchEditAll();this.disabled&&this.enable();return true},cancelEditAll:function(){this.setEditable(false);this._switchViewAll();return true},setHeight:function(b){if(this.$gridContainer){this.$gridContainer.height(b);
this.stretchHeightFn()}},getSelectionModel:function(){return this.sm},getColumnModel:function(){if(!this._cm)this._cm=new UI.grid.ColumnModel({grid:this});return this._cm},getEl:function(){return $(this.containerId)},getMask:function(){return this.getEl()},getIdProperty:function(){return this.options.idProperty||"uuid"},getQuickSearch:function(){return this.quickSearch},getAdvanceSearch:function(){return this.advSearch},getPageProperty:function(){return this.pageProperty},_checkSaveRecord:function(){var b=
this.getNewRow();if(this.isAdd()&&this.isAllowSave()){b.data("allowSave",false);this.fireEvent("blur","save",this)}else b.data("allowSave",true);this.removeListenerOutsideEvent(b);this.hideNewRecord()},_checkUpdateRecord:function(){this.isAllowUpdate()&&this.fireEvent("blur","update",this);this._setAllowUpdate(false)},_setAllowSave:function(b){this.allowSave=!!b;this.getNewRow().data("allowSave",this.allowSave)},isAllowSave:function(){return this.allowSave},_setAllowUpdate:function(b){this.allowUpdate=
!!b},isAllowUpdate:function(){return this.allowUpdate},removeListenerOutsideEvent:function(b){return b.unbind("clickoutside focusoutside")},listenerOutsideEvent:function(b){var c=this,g=!BaseUI.isEmpty(b.data("allowSave"));return function(){b.unbind("clickoutside").bind("clickoutside",function(i){if(b.index()<0)b.unbind("clickoutside");else{i.preventDefault();i.stopPropagation();g?c._checkSaveRecord():c._checkUpdateRecord()}});b.unbind("focusoutside").bind("focusoutside",function(i){if(b.index()<
0)b.unbind("focusoutside");else{i.preventDefault();i.stopPropagation();g?c._checkSaveRecord():c._checkUpdateRecord()}});return b}.defer(250)},fireAction:function(b,c){this.fireEvent("event",b,c)}})});
(function(b){var c=function(g,i){this.$element=b(g);this.options=b.extend({},b.fn.search.defaults,i);this.$button=this.$element.find("button").on("click",b.proxy(this.buttonclicked,this));this.$input=this.$element.find("input").on("keydown",b.proxy(this.keypress,this)).on("keyup",b.proxy(this.keypressed,this));this.$icon=this.$element.find("i");this.activeSearch=""};c.prototype={constructor:c,search:function(g){this.$icon.attr("class","fa fa-remove");this.activeSearch=g;this.$element.trigger("searched",
g)},clear:function(){this.$icon.attr("class","fa fa-search");this.activeSearch="";this.$input.val("");this.$element.trigger("cleared")},action:function(){var g=this.$input.val(),i=g===""||g===this.activeSearch;if(this.activeSearch&&i)this.clear();else g&&this.search(g)},buttonclicked:function(g){g.preventDefault();b(g.currentTarget).is(".disabled, :disabled")||this.action()},keypress:function(g){g.which===13&&g.preventDefault()},keypressed:function(g){if(g.which===13){g.preventDefault();this.action()}else{g=
(g=this.$input.val())&&g===this.activeSearch;this.$icon.attr("class",g?"fa fa-remove":"fa fa-search")}},disable:function(){this.$input.attr("disabled","disabled");this.$button.addClass("disabled")},enable:function(){this.$input.removeAttr("disabled");this.$button.removeClass("disabled")}};b.fn.search=function(g){return this.each(function(){var i=b(this),h=i.data("search"),k=typeof g==="object"&&g;h||i.data("search",h=new c(this,k));typeof g==="string"&&h[g]()})};b.fn.search.defaults={};b.fn.search.Constructor=
c;b(function(){b("body").on("mousedown.search.data-api",".search",function(){var g=b(this);g.data("search")||g.search(g.data())})});UI.grid.Search=function(g){g=g||{};BaseUI.apply(this,g)};BaseUI.extend(UI.grid.Search,UI.Component,{intComponent:function(){},getUrl:function(){return this.url},getId:function(){return this.id},getEl:function(){return b.getCmp(this.getId())},hide:function(){this.getEl().hide()},show:function(){this.getEl().show()},getData:function(){return{}}})})(window.jQuery);
$(function(){UI.grid.CheckboxSelection=function(b){b=b||{};this.prefix="";BaseUI.apply(this,b);this.store=this.grid.getStore();this.query=function(){this.$rowSelector=this.grid.$tbody.find("tr[data-id]");this.$checkboxSelector=this.grid.$tbody.find("td[data-action=select] input[type=checkbox]");this.$checkAll=this.grid.$thead.find("input[type=checkbox]:first");this.$columnCheck=this.grid.$tbody.find("td[data-action=select]")};this.query();var c=this,g=function(i,h,k){i=$(i);h?i.addClass("selected"):
i.removeClass("selected");if(k)c.fireEvent("selectionchange",c,c.getSelection());else{h=c.$rowSelector.find(c.$checkboxSelector).parent().find("input[type=checkbox]:checked").length;c.$checkAll.prop("checked",c.getCount()>0&&c.getCount()==h);c.fireEvent("selectionchange",c,c.getSelected())}};this.grid.$tbody.off("click","td[data-action=select] input[type=checkbox]").on("click","td[data-action=select] input[type=checkbox]",function(i){i.stopPropagation();i=$(this).is(":checked");var h=$($(this).parent().parent().parent().get(0));
g(h,i)});this.$checkAll.off("click").on("click",function(){var i=$(this).is(":checked");c.$rowSelector.find(c.$checkboxSelector).prop("checked",i);g(c.$rowSelector,i,true)});this.$columnCheck.off("click").on("click",function(i){var h=$(this).closest("tr").find("input:checkbox").get(0);if(i.target!=h){$(h).prop("checked",!$(h).is(":checked"));g($(this).parent(),!!$(h).is(":checked"));i.stopPropagation()}});this.$rowSelector.find(this.$checkboxSelector).parent().find("input[type=checkbox]:checked").parent().parent().parent().addClass("selected");
this.$checkAll.prop("checked",false)};BaseUI.extend(UI.grid.CheckboxSelection,UI.Component,{getCount:function(){return this.$rowSelector.find(this.$checkboxSelector).length},getSelected:function(){var b=this.$rowSelector.find(this.$checkboxSelector).parent().find("input[type=checkbox]:checked");if(b.length>0){b=$(b[0]).parent().parent().parent().data("id");if(!BaseUI.isEmpty(b))return this.store.get(b.toString())}return null},getSelection:function(){for(var b=[],c=this.$rowSelector.find(this.$checkboxSelector).parent().find("input[type=checkbox]:checked"),
g=0;g<c.length;g++){var i=$(c[g]).parent().parent().parent().data("id");BaseUI.isEmpty(i)||b.push(this.store.get(i.toString()))}return b},clearSelected:function(){this.$rowSelector.find(this.$checkboxSelector).prop("checked",false);this.$rowSelector.removeClass("selected");this.$checkAll.prop("checked",false);this.fireEvent("selectionchange",this,[])},checkAll:function(){this.$checkAll.prop("checked",true);this.$rowSelector.find(this.$checkboxSelector).prop("checked",true);this.$rowSelector.addClass("selected")},
checkedRow:function(b,c){if(c){this.$rowSelector.find(this.$checkboxSelector).prop("checked",false);this.$rowSelector.removeClass("selected");this.$checkAll.prop("checked",false)}b.find(this.$checkboxSelector).prop("checked",true);b.addClass("selected");this.fireEvent("selectionchange",this,this.getSelected())},refresh:function(){this.$rowSelector.find(this.$checkboxSelector).prop("checked",false);this.$rowSelector.removeClass("selected");this.$checkAll.prop("checked",false);this.query()}});UI.grid.ClickSelection=
function(b){var c=b||{};this.selections=c.selections||[]};BaseUI.extend(UI.grid.ClickSelection,UI.Component,{getSelection:function(){return this.selections},setSelection:function(b){this.selections=b},getSelected:function(){if(BaseUI.isArray(this.selections))return this.selections[this.selections.length-1];return null},clearSelection:function(){this.selections=[]},clearSelected:function(){this.clearSelection()},refresh:function(){this.clearSelection()}})});
(function(){function b(a,d,f){if(a===d)return a!==0||1/a==1/d;if(a==null||d==null)return a===d;if(a._chain)a=a._wrapped;if(d._chain)d=d._wrapped;if(a.isEqual&&e.isFunction(a.isEqual))return a.isEqual(d);if(d.isEqual&&e.isFunction(d.isEqual))return d.isEqual(a);var j=p.call(a);if(j!=p.call(d))return false;switch(j){case "[object String]":return a==String(d);case "[object Number]":return a!=+a?d!=+d:a==0?1/a==1/d:a==+d;case "[object Date]":case "[object Boolean]":return+a==+d;case "[object RegExp]":return a.source==
d.source&&a.global==d.global&&a.multiline==d.multiline&&a.ignoreCase==d.ignoreCase}if(typeof a!="object"||typeof d!="object")return false;for(var m=f.length;m--;)if(f[m]==a)return true;f.push(a);m=0;var n=true;if(j=="[object Array]"){m=a.length;if(n=m==d.length)for(;m--;)if(!(n=m in a==m in d&&b(a[m],d[m],f)))break}else{if("constructor"in a!="constructor"in d||a.constructor!=d.constructor)return false;for(var q in a)if(e.has(a,q)){m++;if(!(n=e.has(d,q)&&b(a[q],d[q],f)))break}if(n){for(q in d)if(e.has(d,
q)&&!m--)break;n=!m}}f.pop();return n}var c=this,g=c._,i={},h=Array.prototype,k=Object.prototype,l=h.slice,o=h.unshift,p=k.toString,r=k.hasOwnProperty,u=h.forEach,x=h.map,v=h.reduce,t=h.reduceRight,y=h.filter,z=h.every,A=h.some,w=h.indexOf,J=h.lastIndexOf;k=Array.isArray;var N=Object.keys,E=Function.prototype.bind,e=function(a){return new C(a)};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports)exports=module.exports=e;exports._=e}else c._=e;e.VERSION="1.3.3";var s=e.each=
e.forEach=function(a,d,f){if(a!=null)if(u&&a.forEach===u)a.forEach(d,f);else if(a.length===+a.length)for(var j=0,m=a.length;j<m;j++){if(j in a&&d.call(f,a[j],j,a)===i)break}else for(j in a)if(e.has(a,j))if(d.call(f,a[j],j,a)===i)break};e.map=e.collect=function(a,d,f){var j=[];if(a==null)return j;if(x&&a.map===x)return a.map(d,f);s(a,function(m,n,q){j[j.length]=d.call(f,m,n,q)});if(a.length===+a.length)j.length=a.length;return j};e.reduce=e.foldl=e.inject=function(a,d,f,j){var m=arguments.length>2;
if(a==null)a=[];if(v&&a.reduce===v){if(j)d=e.bind(d,j);return m?a.reduce(d,f):a.reduce(d)}s(a,function(n,q,B){if(m)f=d.call(j,f,n,q,B);else{f=n;m=true}});if(!m)throw new TypeError("Reduce of empty array with no initial value");return f};e.reduceRight=e.foldr=function(a,d,f,j){var m=arguments.length>2;if(a==null)a=[];if(t&&a.reduceRight===t){if(j)d=e.bind(d,j);return m?a.reduceRight(d,f):a.reduceRight(d)}var n=e.toArray(a).reverse();if(j&&!m)d=e.bind(d,j);return m?e.reduce(n,d,f,j):e.reduce(n,d)};
e.find=e.detect=function(a,d,f){var j;K(a,function(m,n,q){if(d.call(f,m,n,q)){j=m;return true}});return j};e.filter=e.select=function(a,d,f){var j=[];if(a==null)return j;if(y&&a.filter===y)return a.filter(d,f);s(a,function(m,n,q){if(d.call(f,m,n,q))j[j.length]=m});return j};e.reject=function(a,d,f){var j=[];if(a==null)return j;s(a,function(m,n,q){d.call(f,m,n,q)||(j[j.length]=m)});return j};e.every=e.all=function(a,d,f){var j=true;if(a==null)return j;if(z&&a.every===z)return a.every(d,f);s(a,function(m,
n,q){if(!(j=j&&d.call(f,m,n,q)))return i});return!!j};var K=e.some=e.any=function(a,d,f){d||(d=e.identity);var j=false;if(a==null)return j;if(A&&a.some===A)return a.some(d,f);s(a,function(m,n,q){if(j||(j=d.call(f,m,n,q)))return i});return!!j};e.include=e.contains=function(a,d){var f=false;if(a==null)return f;if(w&&a.indexOf===w)return a.indexOf(d)!=-1;return f=K(a,function(j){return j===d})};e.invoke=function(a,d){var f=l.call(arguments,2);return e.map(a,function(j){return(e.isFunction(d)?d||j:j[d]).apply(j,
f)})};e.pluck=function(a,d){return e.map(a,function(f){return f[d]})};e.max=function(a,d,f){if(!d&&e.isArray(a)&&a[0]===+a[0])return Math.max.apply(Math,a);if(!d&&e.isEmpty(a))return-Infinity;var j={computed:-Infinity};s(a,function(m,n,q){n=d?d.call(f,m,n,q):m;n>=j.computed&&(j={value:m,computed:n})});return j.value};e.min=function(a,d,f){if(!d&&e.isArray(a)&&a[0]===+a[0])return Math.min.apply(Math,a);if(!d&&e.isEmpty(a))return Infinity;var j={computed:Infinity};s(a,function(m,n,q){n=d?d.call(f,m,
n,q):m;n<j.computed&&(j={value:m,computed:n})});return j.value};e.shuffle=function(a){var d=[],f;s(a,function(j,m){f=Math.floor(Math.random()*(m+1));d[m]=d[f];d[f]=j});return d};e.sortBy=function(a,d,f){var j=e.isFunction(d)?d:function(m){return m[d]};return e.pluck(e.map(a,function(m,n,q){return{value:m,criteria:j.call(f,m,n,q)}}).sort(function(m,n){var q=m.criteria,B=n.criteria;if(q===void 0)return 1;if(B===void 0)return-1;return q<B?-1:q>B?1:0}),"value")};e.groupBy=function(a,d){var f={},j=e.isFunction(d)?
d:function(m){return m[d]};s(a,function(m,n){var q=j(m,n);(f[q]||(f[q]=[])).push(m)});return f};e.sortedIndex=function(a,d,f){f||(f=e.identity);for(var j=0,m=a.length;j<m;){var n=j+m>>1;f(a[n])<f(d)?j=n+1:m=n}return j};e.toArray=function(a){if(!a)return[];if(e.isArray(a))return l.call(a);if(e.isArguments(a))return l.call(a);if(a.toArray&&e.isFunction(a.toArray))return a.toArray();return e.values(a)};e.size=function(a){return e.isArray(a)?a.length:e.keys(a).length};e.first=e.head=e.take=function(a,
d,f){return d!=null&&!f?l.call(a,0,d):a[0]};e.initial=function(a,d,f){return l.call(a,0,a.length-(d==null||f?1:d))};e.last=function(a,d,f){return d!=null&&!f?l.call(a,Math.max(a.length-d,0)):a[a.length-1]};e.rest=e.tail=function(a,d,f){return l.call(a,d==null||f?1:d)};e.compact=function(a){return e.filter(a,function(d){return!!d})};e.flatten=function(a,d){return e.reduce(a,function(f,j){if(e.isArray(j))return f.concat(d?j:e.flatten(j));f[f.length]=j;return f},[])};e.without=function(a){return e.difference(a,
l.call(arguments,1))};e.uniq=e.unique=function(a,d,f){f=f?e.map(a,f):a;var j=[];if(a.length<3)d=true;e.reduce(f,function(m,n,q){if(d?e.last(m)!==n||!m.length:!e.include(m,n)){m.push(n);j.push(a[q])}return m},[]);return j};e.union=function(){return e.uniq(e.flatten(arguments,true))};e.intersection=e.intersect=function(a){var d=l.call(arguments,1);return e.filter(e.uniq(a),function(f){return e.every(d,function(j){return e.indexOf(j,f)>=0})})};e.difference=function(a){var d=e.flatten(l.call(arguments,
1),true);return e.filter(a,function(f){return!e.include(d,f)})};e.zip=function(){for(var a=l.call(arguments),d=e.max(e.pluck(a,"length")),f=Array(d),j=0;j<d;j++)f[j]=e.pluck(a,""+j);return f};e.indexOf=function(a,d,f){if(a==null)return-1;var j;if(f){f=e.sortedIndex(a,d);return a[f]===d?f:-1}if(w&&a.indexOf===w)return a.indexOf(d);f=0;for(j=a.length;f<j;f++)if(f in a&&a[f]===d)return f;return-1};e.lastIndexOf=function(a,d){if(a==null)return-1;if(J&&a.lastIndexOf===J)return a.lastIndexOf(d);for(var f=
a.length;f--;)if(f in a&&a[f]===d)return f;return-1};e.range=function(a,d,f){if(arguments.length<=1){d=a||0;a=0}f=arguments[2]||1;for(var j=Math.max(Math.ceil((d-a)/f),0),m=0,n=Array(j);m<j;){n[m++]=a;a+=f}return n};var L=function(){};e.bind=function(a,d){var f,j;if(a.bind===E&&E)return E.apply(a,l.call(arguments,1));if(!e.isFunction(a))throw new TypeError;j=l.call(arguments,2);return f=function(){if(!(this instanceof f))return a.apply(d,j.concat(l.call(arguments)));L.prototype=a.prototype;var m=
new L,n=a.apply(m,j.concat(l.call(arguments)));if(Object(n)===n)return n;return m}};e.bindAll=function(a){var d=l.call(arguments,1);if(d.length==0)d=e.functions(a);s(d,function(f){a[f]=e.bind(a[f],a)});return a};e.memoize=function(a,d){var f={};d||(d=e.identity);return function(){var j=d.apply(this,arguments);return e.has(f,j)?f[j]:f[j]=a.apply(this,arguments)}};e.delay=function(a,d){var f=l.call(arguments,2);return setTimeout(function(){return a.apply(null,f)},d)};e.defer=function(a){return e.delay.apply(e,
[a,1].concat(l.call(arguments,1)))};e.throttle=function(a,d){var f,j,m,n,q,B,M=e.debounce(function(){q=n=false},d);return function(){f=this;j=arguments;var O=function(){m=null;q&&a.apply(f,j);M()};m||(m=setTimeout(O,d));if(n)q=true;else B=a.apply(f,j);M();n=true;return B}};e.debounce=function(a,d,f){var j;return function(){var m=this,n=arguments;f&&!j&&a.apply(m,n);clearTimeout(j);j=setTimeout(function(){j=null;f||a.apply(m,n)},d)}};e.once=function(a){var d=false,f;return function(){if(d)return f;
d=true;return f=a.apply(this,arguments)}};e.wrap=function(a,d){return function(){var f=[a].concat(l.call(arguments,0));return d.apply(this,f)}};e.compose=function(){var a=arguments;return function(){for(var d=arguments,f=a.length-1;f>=0;f--)d=[a[f].apply(this,d)];return d[0]}};e.after=function(a,d){if(a<=0)return d();return function(){if(--a<1)return d.apply(this,arguments)}};e.keys=N||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var d=[],f;for(f in a)if(e.has(a,f))d[d.length]=
f;return d};e.values=function(a){return e.map(a,e.identity)};e.functions=e.methods=function(a){var d=[],f;for(f in a)e.isFunction(a[f])&&d.push(f);return d.sort()};e.extend=function(a){s(l.call(arguments,1),function(d){for(var f in d)a[f]=d[f]});return a};e.pick=function(a){var d={};s(e.flatten(l.call(arguments,1)),function(f){if(f in a)d[f]=a[f]});return d};e.defaults=function(a){s(l.call(arguments,1),function(d){for(var f in d)if(a[f]==null)a[f]=d[f]});return a};e.clone=function(a){if(!e.isObject(a))return a;
return e.isArray(a)?a.slice():e.extend({},a)};e.tap=function(a,d){d(a);return a};e.isEqual=function(a,d){return b(a,d,[])};e.isEmpty=function(a){if(a==null)return true;if(e.isArray(a)||e.isString(a))return a.length===0;for(var d in a)if(e.has(a,d))return false;return true};e.isElement=function(a){return!!(a&&a.nodeType==1)};e.isArray=k||function(a){return p.call(a)=="[object Array]"};e.isObject=function(a){return a===Object(a)};e.isArguments=function(a){return p.call(a)=="[object Arguments]"};if(!e.isArguments(arguments))e.isArguments=
function(a){return!!(a&&e.has(a,"callee"))};e.isFunction=function(a){return p.call(a)=="[object Function]"};e.isString=function(a){return p.call(a)=="[object String]"};e.isNumber=function(a){return p.call(a)=="[object Number]"};e.isFinite=function(a){return e.isNumber(a)&&isFinite(a)};e.isNaN=function(a){return a!==a};e.isBoolean=function(a){return a===true||a===false||p.call(a)=="[object Boolean]"};e.isDate=function(a){return p.call(a)=="[object Date]"};e.isRegExp=function(a){return p.call(a)=="[object RegExp]"};
e.isNull=function(a){return a===null};e.isUndefined=function(a){return a===void 0};e.has=function(a,d){return r.call(a,d)};e.noConflict=function(){c._=g;return this};e.identity=function(a){return a};e.times=function(a,d,f){for(var j=0;j<a;j++)d.call(f,j)};e.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};e.result=function(a,d){if(a==null)return null;var f=a[d];return e.isFunction(f)?
f.call(a):f};e.mixin=function(a){s(e.functions(a),function(d){P(d,e[d]=a[d])})};var Q=0;e.uniqueId=function(a){var d=Q++;return a?a+d:d};e.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var F=/.^/,D={"\\":"\\","'":"'",r:"\r",n:"\n",t:"\t",u2028:"\u2028",u2029:"\u2029"},G;for(G in D)D[D[G]]=G;var R=/\\|'|\r|\n|\t|\u2028|\u2029/g,S=/\\(\\|'|r|n|t|u2028|u2029)/g,H=function(a){return a.replace(S,function(d,f){return D[f]})};e.template=function(a,
d,f){f=e.defaults(f||{},e.templateSettings);a="__p+='"+a.replace(R,function(m){return"\\"+D[m]}).replace(f.escape||F,function(m,n){return"'+\n_.escape("+H(n)+")+\n'"}).replace(f.interpolate||F,function(m,n){return"'+\n("+H(n)+")+\n'"}).replace(f.evaluate||F,function(m,n){return"';\n"+H(n)+"\n;__p+='"})+"';\n";f.variable||(a="with(obj||{}){\n"+a+"}\n");a="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+a+"return __p;\n";var j=new Function(f.variable||"obj","_",a);
if(d)return j(d,e);d=function(m){return j.call(this,m,e)};d.source="function("+(f.variable||"obj")+"){\n"+a+"}";return d};e.chain=function(a){return e(a).chain()};var C=function(a){this._wrapped=a};e.prototype=C.prototype;var I=function(a,d){return d?e(a).chain():a},P=function(a,d){C.prototype[a]=function(){var f=l.call(arguments);o.call(f,this._wrapped);return I(d.apply(e,f),this._chain)}};e.mixin(e);s(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var d=h[a];C.prototype[a]=
function(){var f=this._wrapped;d.apply(f,arguments);var j=f.length;if((a=="shift"||a=="splice")&&j===0)delete f[0];return I(f,this._chain)}});s(["concat","join","slice"],function(a){var d=h[a];C.prototype[a]=function(){return I(d.apply(this._wrapped,arguments),this._chain)}});C.prototype.chain=function(){this._chain=true;return this};C.prototype.value=function(){return this._wrapped}}).call(this);
(function(b,c,g){function i(h,k){function l(r){b(o).each(function(){var u=b(this);this!==r.target&&!u.has(r.target).length&&u.triggerHandler(k,[r.target])})}k=k||h+g;var o=b(),p=h+"."+k+"-special-event";b.event.special[k]={setup:function(){o=o.add(this);o.length===1&&b(c).bind(p,l)},teardown:function(){o=o.not(this);o.length===0&&b(c).unbind(p)},add:function(r){var u=r.handler;r.handler=function(x,v){x.target=v;u.apply(this,arguments)}}}}b.map("click dblclick mousemove mousedown mouseup mouseover mouseout change select submit keydown keypress keyup".split(" "),
function(h){i(h)});i("focusin","focus"+g);i("focusout","blur"+g);b.addOutsideEvent=i})(jQuery,document,"outside");